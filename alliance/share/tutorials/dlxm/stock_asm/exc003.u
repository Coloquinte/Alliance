;  ###----------------------------------------------------------------###
;  #									#
;  # file	: exc002.u						#
;  # date	: Apr  1 1993						#
;  # descr.	: functional test for dlx				#
;  #									#
;  ###----------------------------------------------------------------###

	;  ###--------------------------------------------------------###
	;  #   exceptions :						#
	;  #     - arithmetic overflow (substract)			#
	;  ###--------------------------------------------------------###

data		equ	X"52d4aec6"		; a big positive data

		org	X"7fffff00"
		start	init

init:
		loadi	r31, back_from_exception
		loadi	r10, data		; big positive data in r10
		loadi	r11, data		; same data in r11

	;  ###--------------------------------------------------------###
	;  #   substract generating an overflow				#
	;  ###--------------------------------------------------------###

		sub	r12, r0 , r10
		sub	r10, r12, r10		; EXCEPTION (overflow)

	;  ###--------------------------------------------------------###
	;  #   after returning from exception check that r10 has not	#
	;  # been altered						#
	;  ###--------------------------------------------------------###

back_from_exception:
		sne	r20, r10, r11		; check that add has failed
		bnez	r20, bad
		nop
		j	good
		nop

		org	X"7ffffff0"
good		j	good
		nop
bad		j	bad
		nop
		end
