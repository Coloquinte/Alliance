.\"   $Id: scr.1,v 1.1 1999/05/31 17:30:14 alliance Exp $
.\" @(#)Labo.l 0.0 92/09/24 UPMC; Author: El housseine REJOUAN
.pl -.4
.TH SCR 1 "October 1, 1997" "ASIM/LIP6" "CAO\-VLSI Reference Manual"
.SH NAME
.TP
scr
 - Standard Cell Router
.so man1/alc_origin.1
.SH SYNOPSIS
.TP
\fBscr\fP 
[\fB-p\fP] [\fB-r\fP] [\fB-c \fIChannelName\fP] [\fB-i \fIIterationNumber \fP] [\fB-l \fIRowNumber\fP] [\fB-a \fISupplyNumber\fP]
.br
[\fB-o \fIOutputFileName\fP] \fIsource\fP 
.br
.SH DESCRIPTION
\fBscr\fP is an automatic place and route tool for standard-cells.
.br

\fB1/ standard cells\fP
.br
\fBscr\fP uses a catalog file whose name is defined by the environment variable \fBMBK_CATAL_NAME\fP. This file must contain the standard cells names.
.br
The cells must have the same height, but they can have different width (multiple of the pitch).
.br
Power and ground connectors defined by the environment variable \fBMBK_VDD\fP and \fBMBK_VSS\fP must be
 in metal1 on the WEST and EAST sides of the abutment-box of the cells.
.br
Other connectors must be in metal2  only on the NORTH and SOUTH sides of the abutment-box of the cells.
They must be pitched.
.br
If two connectors of the cell have the same name, the router will consider them electrically connected inside the cell. \fBscr\fP uses this feature to go through the cell.
.br
One or several attributes can be associated with each cell. The attributes that concern the router are:
.br
\fBC\fR : for Catalog, associated to the leaf cells that will not be flattened. 
.br
\fBF\fR : for Feed-through, associated to the cells which are used as feed-through, a feed-through may do not appear in the logical net-list. 
.br
For more details on the catalog file see catal(5).
.br
The files describing the physical and the logical view for each cell must be located in one of the directories defined by the environment variable \fBMBK_CATA_LIB\fP.

\fB2/ input net-list\fP
.br
The \fIsource\fP file describes the input net-list.
.br
\fBscr\fP supports a hierarchical net-list. In this case the net-list is flattened by the router according to the catalog file. The net-list format can be : structural VHDL, EDIF, or ALLIANCE internal format according to the environment variable \fBMBK_IN_LO\fP.
.br

\fB3/ output layout\fP
.br
The file containing the routed block will have the name \fIsource\fP if the -o option is not used, otherwise the \fIOutputFileName\fP is used. The output format is defined by the environment variable \fBMBK_OUT_PH\fP.
.br
The router uses two layers for routing: metal1 for the horizontal wires, and metal2 for the vertical wi
res.
.br
The first metal1 horizontal wires are six LAMBDAs from the NORTH and SOUTH abutment-box sides of the cells.
 The horizontal PITCH between metal1 wires is equal to five LAMBDAs.
A six LAMBDAs margin is ensured between the extreme horizontal wires of the circuit and its NORTH and S
OUTH abutment-box sides.
.br
The first metal2 vertical wires are three LAMBDAs from the WEST and EAST abutment-box sides of routed circu
it. The vertical PITCH between metal2 wires is equal to six LAMBDAs.
.br
There are two possibilities for the output layout:
.br
If the -c option is used, the routing channels and cell rows are instanciated as intermediate hierarchical blocks.(their names are prefixed by \fIChannelName\fP). Otherwise the instances of the routed figure are the input net-list leaf cells.
.br
The names for power and ground sources are given by the environment variables MBK_VDD and MBK_VSS. The
default values are vdd and vss.
.br
All power and ground are internally connected by two vertical metal2 wires (one for VDD, one for VSS).
It is possible to increase the number of vertical power and ground wires with the -a option.
.br

\fB4/ Optional cells placement file\fP
.br
A user defined placement can be specified, thanks to a placement file.
.br
The optional placement file must have the same name as the input net-list with a extension that denotes the format defined by the environment variable \fBMBK_IN_PH\fP.
.br
The circuit to be routed must be composed of horizontal rows. The height of each row is the height of the standard-cells. The cells must not overlap.
.br
This placement can also be hierarchical. In this case the hierarchy must be the same as the input net-list.  Each logical instance must correspond to one and only one physical instance, and each physical instance must correspond to one and only one logical instance.
.br
This constraint does not apply to the physical cells with F attribute into the catalog file. 
.br

\fB5/ Optional connectors and feed-through placement file\fP
.br
The placement of connectors can be also specified : which connector on which side, and the relative order of connectors on one side.
.br 
The same logical connector can be placed on several sides.
.br
This information is contained in a file that has the same name as the input net-list file, with the \fB".scr"\fP extension.
.br
In this \fIsource\fP\fB.scr\fP file, all lines begining whith a \fB"#"\fP (sharp) are comments.
.br
To define the position of the connectors four instructions can be  used :
.IP
\fB PLACE_PHCON_NORTH \fR \fIname order\fP \fB;\fR
.br
\fB PLACE_PHCON_SOUTH \fR \fIname order\fP \fB;\fR
.br
\fB PLACE_PHCON_WEST \fR \fIname order\fP \fB;\fR
.br
\fB PLACE_PHCON_EAST \fR \fIname order\fP \fB;\fR
.LP
where \fI"name"\fP is the logical connector name and \fI"order"\fP is the index.
.br
If the relative placement on a given side is undefined the \fI"order"\fP parameter takes the value \fB"-1"\fP.
.br
In \fB WEST \fR and \fB EAST \fR sides, the \fI order \fP parameter of connectors on these sides can not be defined by the user (so the \fI order \fP parameter on these sides takes the value "-1").
.br
A vectorized syntax is usable for buses.
.br
\fBscr\fR can be place vertical and horizontal feed-through in the routed circuit (this can be used by the floor-plan router to route over the block).
.br
Two instructions are usable :
.br
.IP
\fB HOR_FEED_THROUGH\fR \fIn\fP \fB;\fR
.br
\fB VER_FEED_THROUGH\fR \fIm\fP \fB;\fR
.LP
where \fIn\fP and \fIm\fP are the number of feed-through.
.br
The horizontal feed-throughs are placed in the middle channel of the routed circuit.
.br 
The vertical feed-throughs are placed regulary over the entire width of the routed circuit according to the number of vertical power and ground wires. If a null number is given for -a option, the vertical feed-throughs are placed in the middle of the routed circuit.
.br
This is an example :
.IP
\fB PLACE_PHCON_NORTH\fR in3 4\fB;\fR
.br
\fB PLACE_PHCON_NORTH\fR in2 1\fB;\fR
.br
\fB PLACE_PHCON_NORTH\fR in1 2\fB;\fR
.br
\fB PLACE_PHCON_SOUTH\fR in0 4\fB;\fR
.br
\fB PLACE_PHCON_SOUTH\fR in5 0\fB;\fR
.br
\fB PLACE_PHCON_WEST\fR in7 -1\fB;\fR
.br
\fB PLACE_PHCON_EAST\fR in6 -1\fB;\fR
.LP
The result of this set of instructions, is a circuit having on it's \fI"NORTH"\fP side
four connectors whose names are the following order (i.e. from left to right : in2, in1 and in3), on it's \fI"SOUTH"\fP side two connectors whose names are the following order (i.e. from left to right : in5 and in0).
.br
If the position of a connector on a given side is not crucial the "order" parameter may be set to "-1".
.br
for examples :
.IP
\fB PLACE_PHCON_NORTH\fR in3 -1\fB;\fR
.LP
The syntax has the same structure as before but the parameters "name" and "order" are written as vectors.
.br
for examples :
.br
The following sets of instruction give the same result.
.IP
 Non vectorized structure :
\fB PLACE_PHCON_NORTH\fR in[3] 4\fB;\fR
.br
\fB PLACE_PHCON_NORTH\fR in[2] 3\fB;\fR
.br
\fB PLACE_PHCON_NORTH\fR in[1] 2\fB;\fR
.br
\fB PLACE_PHCON_NORTH\fR in[0] 1\fB;\fR
.br
\fB PLACE_PHCON_WEST\fR in[5] -1\fB;\fR
.br
\fB PLACE_PHCON_WEST\fR in[6] -1\fB;\fR
.IP
 Vectorized  structure :
\fB PLACE_PHCON_NORTH\fR in[0:3] 1:4\fB;\fR
.br
\fB PLACE_PHCON_WEST\fR in[0:3] -1\fB;\fR
.LP
To vectorized buses, the characters \fB"()"\fR can be used instead \f4"[]"\fR.
.br
.SH OPTIONS
.TP 20
\-o \fIOutputFileName\fP 
renames the output file name to OutputFileName. By default, the name of the input net-list file is used.
.TP 20
\-p 
This option invokes the automatic placement process. 
.TP 20
\-r 
This option invokes the automatic routing process.
.br
So \fBscr\fP must be used with at least one of -p or -r options:
.br
-p	automatic place, no route.
.br
-r	automatic route, no place.
.br
-p -r	automatic place and route.
.TP 20
\-c \fIChannelName\fP 
If this option is used ,the rows and channels will be instanciated as intermediate hierarchical levels.
.br
Otherwise the result will be flattened to the standard cells.
.TP 20
\-i \fIIterationNumber\fP 
This option is used to improve the quality of the placement, and consequently of the routing. The default value is the number of cells.
.TP 20
\-l \fIRowNumber\fP 
This option allows the designer to set the number of rows.
The default value is computed to provide a square result.
.TP 20
\-a \fISupplyNumber\fP 
This option allows the designer to set the number of vertical power and ground wires. The default value is one.
.br

.SH ENVIRONMENT
\f4scr\fR relies on the proper setting of the following environment variables :
.TP 20
\f4MBK_CATA_LIB\fR(1)
gives the path to the cell libraries. 
.TP 20
\f4MBK_WORK_LIB\fR(1)
furnishes the path to the working directory.
.TP 20
\f4MBK_IN_PH\fR(1)
indicates the input layout format.
.TP 20
\f4MBK_OUT_PH\fR(1)
indicates the output layout format.
.TP 20
\f4MBK_IN_LO\fR(1)
indicates the input structural file format.
.TP 20
\f4MBK_VDD\fR(1)
sets the name of power supply. "vdd" is the default. Every external port of the circuit whose name contain this string will be considered as a power supply.
.TP 20
\f4MBK_VSS\fR(1)
sets the name of ground. "vss" is the default. Every external port of the circuit whose name contain this string will be considered as a ground.

.SH EXAMPLES
To use \fBscr\fP, some environment variables must be set :
.br
If the ALLIANCE format is used, the user must have the following environment:
.br
.BR 	MBK_CATA_LIB 
=/labo/cells/sclib/prol10
.br
.BR 	MBK_IN_LO 
=vst
.br
.BR 	MBK_IN_PH 
=ap
.br
.BR 	MBK_OUT_PH 
=ap
.br
.BR 	MBK_CATAL_NAME 
=CATAL
.br
.BR 	MBK_WORK_LIB 
=. 
.br
.BR 	MBK_VDD 
=vdd 
.br
.BR 	MBK_VSS 
=vss 
.br
The command line to be executed for routing the circuit called, for example, "core" with all options is:
.br
.TP
\fBscr\fP -p -r -i 500 -l 6 -c chan -a 2 -o core_r core 
.br
The input net-list will be the file core.vst
.br
The resulting file will be core_r.ap
.br
The number of iterations is equal to 500
.br
The number of rows is equal to 6
.br
The result will be hierarchical
.br
Two power and ground wires are placed in the routed circuit.
.br
.TP
\fBscr\fP -r -p -a 3 -o alur  alu 
.br
This command makes a placement and routing on the circuit "alu" with 3 vertical power and ground wires.
.br
The resulting file will be alur.ap
.br
.TP
\fBscr\fP -r -p -a 0 alu 
.bR
If a null number is given for the -a option as in this example,there will be no vertical power and ground wires and all the external power and ground connectors will have different names.
.br
The resulting file will be alu.ap
.br
.SH SEE ALSO
.BR mbkenv (3),
.BR bbr (1),
.BR sclib (1),
.BR ring (1),
.BR genlib(1),
.BR catal(5),



.SH DIAGNOSTICS
.br
.BR 1/
\fISegment and via lists must be NULL!!\fP
.br
This message can appear if:
.br
-The user tries to route a figure already routed.
.br
-The catalog file is not accessible, or it is incomplete and the router has flattened a cell not included in the catalog.
.br

.BR 2/ 
\fILogic "INS_NAME" does not exist in the physical view!!\fP
.br
Logic instance in the net-list is not declared in the placement.
.br

.BR 3/ 
\fIPhysical "INS_NAME" does not exist in the logical view!!\fP
.br
Physical instance in the placement file is not declared in the net-list.
.br

.BR 4/ 
\fIPhysical connector "CON_NAME" does not exist in the logical view!!\fP
.br
The physical internal connector called "CON_NAME" is not declared in the net-list.

.BR 5/ 
\fIImpossible configuration : the number of connectors to be placed on south/north side is greater than the existing number of pitchs.\fP
.br
In this case, the user may user lower number of rows to overcome this placement problem.

.so man1/alc_bug_report.1

